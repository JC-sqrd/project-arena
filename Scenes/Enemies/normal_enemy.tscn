[gd_scene load_steps=50 format=3 uid="uid://b5atlsgxuwett"]

[ext_resource type="Script" uid="uid://c82id00axlli8" path="res://Scripts/Enemy/Enemy.gd" id="1_8wxgr"]
[ext_resource type="Script" uid="uid://sc7t52uxqk2w" path="res://Scripts/Entity/ManaManager.gd" id="2_e7npy"]
[ext_resource type="Script" uid="uid://cdiu1n82272s0" path="res://Scripts/Enemy/AddGoldOnSlain.gd" id="2_k2cwq"]
[ext_resource type="Script" uid="uid://5fujd5ybwb45" path="res://Scripts/Combat/StatusEffects/StatusEffectManager.gd" id="2_m6v5t"]
[ext_resource type="Script" uid="uid://cmnd4g4du2b0u" path="res://Scripts/StatSystem/StatManager.gd" id="2_ntwkw"]
[ext_resource type="Script" uid="uid://dm3uuggj1g47y" path="res://Scripts/Combat/HitListener.gd" id="2_wvfm5"]
[ext_resource type="Script" uid="uid://bmcifytwc82pu" path="res://Scripts/Enemy/AddExpOnSlain.gd" id="2_yqgnx"]
[ext_resource type="Script" uid="uid://c8sj8b1npavnd" path="res://Scripts/Combat/CombatEffects/DamageEffect.gd" id="3_dq2xg"]
[ext_resource type="Shader" uid="uid://dg3gx1shjub03" path="res://Shaders/hit_flash.gdshader" id="3_jkojm"]
[ext_resource type="Script" uid="uid://b7ufh45hbdc8e" path="res://Scripts/EntitySprite.gd" id="5_5x8ff"]
[ext_resource type="PackedScene" uid="uid://bau78s0ws2us8" path="res://Scenes/Components/hit_receiver.tscn" id="6_kla3v"]
[ext_resource type="Texture2D" uid="uid://yigasothu8cv" path="res://Sprites/Enemy/Normal Enemy/FastEnemy_Front.png" id="10_4amni"]
[ext_resource type="Texture2D" uid="uid://d20xo7dtl47io" path="res://Sprites/Enemy/Normal Enemy/FastEnemy_Front_Hurt_Anim.png" id="11_lnnef"]
[ext_resource type="SpriteFrames" uid="uid://vtufrjrnc2av" path="res://Scripts/Resources/Animations/hit_spark_2D_anim.tres" id="13_crijp"]
[ext_resource type="Script" uid="uid://csugnbipwc8rl" path="res://Scripts/Combat/DamageListener/Mitigation/BlockMultiplier.gd" id="19_v3qv3"]
[ext_resource type="Script" uid="uid://xabwgpydpxaf" path="res://Scripts/Combat/HitSpriteAnimation.gd" id="20_n66tn"]
[ext_resource type="Script" uid="uid://i2thtk66tgpr" path="res://Scripts/Enemy/AI/FollowPlayer.gd" id="21_wnamf"]
[ext_resource type="Script" uid="uid://ctjia3ovr0cyg" path="res://Scripts/Combat/DamageListener/DamageListener.gd" id="22_to4bi"]
[ext_resource type="Script" uid="uid://mgrw0is6pnqq" path="res://Scripts/Combat/DamageListener/Mitigation/MitigationEffect.gd" id="23_1ypxb"]
[ext_resource type="Script" uid="uid://c2c43sih3sxp0" path="res://Scripts/Entity/LevelManager.gd" id="24_tqk11"]
[ext_resource type="Script" uid="uid://cdn8b5gg8mfb8" path="res://Scripts/Entity/HealthManager.gd" id="25_uekoc"]
[ext_resource type="Script" uid="uid://bgka26pbphks7" path="res://Scripts/StatSystem/Stat.gd" id="27_8hbk4"]
[ext_resource type="Script" uid="uid://clr8tbibqclow" path="res://Scripts/StatSystem/Stats/StatScaler.gd" id="28_xylax"]
[ext_resource type="Script" uid="uid://cxjykw6uf7uti" path="res://Scripts/Loot/EntityLootDropManager.gd" id="29_sk5q4"]
[ext_resource type="PackedScene" uid="uid://cj01qxw0g7t0" path="res://Scenes/Pickupables/exp_orb.tscn" id="30_qoj44"]
[ext_resource type="Script" uid="uid://dxpbdqwawfhk5" path="res://Scripts/Loot/LootDropper.gd" id="31_b73cx"]
[ext_resource type="PackedScene" uid="uid://c5ynpo7p54mt" path="res://Scenes/UI/health_bar.tscn" id="36_spbdk"]
[ext_resource type="Script" uid="uid://bowwp5s7jndt1" path="res://Scripts/Combat/UI/DamageNumber.gd" id="37_hr30q"]
[ext_resource type="AudioStream" uid="uid://qwxiqx2wt0qp" path="res://Placeholders/Audio/qubodupImpactMeat02.ogg" id="38_wst1g"]
[ext_resource type="Script" uid="uid://cyct4fbw7k0sb" path="res://Scripts/Audio/EntityHitStreamPlayer2D.gd" id="39_i6u0l"]
[ext_resource type="Script" uid="uid://botqhhrbfbmcw" path="res://Scripts/Enemy/EntityHitParticle.gd" id="40_sfnxl"]
[ext_resource type="Script" uid="uid://ca00kjhgjanwc" path="res://Scripts/EntityCollisionShape2D.gd" id="43_4gaxh"]
[ext_resource type="Script" uid="uid://cwvji5ut5gepk" path="res://Scripts/Loot/RandomLootDropper.gd" id="44_2uo1e"]
[ext_resource type="PackedScene" uid="uid://b74ro0m7sh4l0" path="res://Scenes/Pickupables/rare_item_picker_pickup.tscn" id="45_xwpxq"]
[ext_resource type="PackedScene" uid="uid://bdbihdl1o28gy" path="res://Scenes/Pickupables/common_item_picker_pickup.tscn" id="46_x3gb8"]
[ext_resource type="PackedScene" uid="uid://bpntae4f4ajb7" path="res://Scenes/Particles/enemy_hit_spark_particle.tscn" id="50_1vlta"]
[ext_resource type="PackedScene" uid="uid://e1v3gxd3patv" path="res://Scenes/Pickupables/heal_pickupable.tscn" id="52_adoa2"]
[ext_resource type="PackedScene" uid="uid://cqnisx62mit3n" path="res://Scenes/Pickupables/gold_coin.tscn" id="59_k26d3"]
[ext_resource type="Script" uid="uid://4aq4lbc1j01f" path="res://Scripts/Loot/GoldDropper.gd" id="60_1bywy"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_wfwwp"]
resource_local_to_scene = true
shader = ExtResource("3_jkojm")
shader_parameter/hit_opacity = 0.0
shader_parameter/modulate = Color(1, 1, 1, 1)

[sub_resource type="AtlasTexture" id="AtlasTexture_g7q78"]
atlas = ExtResource("11_lnnef")
region = Rect2(0, 0, 96, 96)

[sub_resource type="AtlasTexture" id="AtlasTexture_hduax"]
atlas = ExtResource("11_lnnef")
region = Rect2(96, 0, 96, 96)

[sub_resource type="AtlasTexture" id="AtlasTexture_2ik7m"]
atlas = ExtResource("11_lnnef")
region = Rect2(192, 0, 96, 96)

[sub_resource type="AtlasTexture" id="AtlasTexture_ctxbq"]
atlas = ExtResource("11_lnnef")
region = Rect2(288, 0, 96, 96)

[sub_resource type="AtlasTexture" id="AtlasTexture_xi4fp"]
atlas = ExtResource("11_lnnef")
region = Rect2(384, 0, 96, 96)

[sub_resource type="AtlasTexture" id="AtlasTexture_2iw72"]
atlas = ExtResource("11_lnnef")
region = Rect2(480, 0, 96, 96)

[sub_resource type="SpriteFrames" id="SpriteFrames_b66ty"]
animations = [{
"frames": [],
"loop": true,
"name": &"default",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("10_4amni")
}],
"loop": true,
"name": &"front",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_g7q78")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_hduax")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_2ik7m")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_ctxbq")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_xi4fp")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_2iw72")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_g7q78")
}],
"loop": false,
"name": &"hurt",
"speed": 12.0
}]

[sub_resource type="CircleShape2D" id="CircleShape2D_ki2kn"]
radius = 30.0

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_usn8p"]
bg_color = Color(0.111197, 0.111197, 0.111197, 1)
corner_radius_top_left = 10
corner_radius_top_right = 10
corner_radius_bottom_right = 10
corner_radius_bottom_left = 10

[node name="FastEnemy" type="CharacterBody2D" node_paths=PackedStringArray("hit_listener", "hit_receiver", "stat_manager", "level_manager", "health_manager", "status_effect_manager", "damage_listener") groups=["Enemy", "Hittable"]]
collision_layer = 2
motion_mode = 1
script = ExtResource("1_8wxgr")
hit_listener = NodePath("HitListener")
hit_receiver = NodePath("HitReceiver")
stat_manager = NodePath("Stats")
level_manager = NodePath("LevelManager")
health_manager = NodePath("HealthManager")
status_effect_manager = NodePath("StatusEffectManager")
damage_listener = NodePath("DamageListener")

[node name="HitListener" type="Node" parent="."]
script = ExtResource("2_wvfm5")

[node name="DamageEffect" type="Node" parent="HitListener" node_paths=PackedStringArray("damage_stat")]
script = ExtResource("3_dq2xg")
damage_stat = NodePath("../../Stats/AttackDamage")

[node name="AddGoldOnSlain" type="Node" parent="."]
script = ExtResource("2_k2cwq")
gold_add = 5.0

[node name="AddExpOnSlain" type="Node" parent="."]
script = ExtResource("2_yqgnx")
exp_add = 5.0
exp_label_color = Color(0.917647, 0, 0.941176, 1)

[node name="HitReceiver" parent="." instance=ExtResource("6_kla3v")]

[node name="ManaManager" type="Node" parent="." node_paths=PackedStringArray("stat_manager", "max_mana", "current_mana", "mana_regen")]
script = ExtResource("2_e7npy")
stat_manager = NodePath("../Stats")
max_mana = NodePath("../Stats/MaxMana")
current_mana = NodePath("../Stats/Mana")
mana_regen = NodePath("../Stats/ManaRegen")

[node name="StatusEffectManager" type="Node" parent="." node_paths=PackedStringArray("entity")]
script = ExtResource("2_m6v5t")
entity = NodePath("..")

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="." node_paths=PackedStringArray("entity")]
texture_filter = 1
material = SubResource("ShaderMaterial_wfwwp")
position = Vector2(0, -24)
sprite_frames = SubResource("SpriteFrames_b66ty")
animation = &"front"
script = ExtResource("5_5x8ff")
entity = NodePath("..")

[node name="VisibleOnScreenEnabler2D2" type="VisibleOnScreenEnabler2D" parent="AnimatedSprite2D"]
position = Vector2(-36, -2.66667)
scale = Vector2(0.72, 0.506667)
rect = Rect2(0, 0, 100, 100)
enable_node_path = NodePath("")

[node name="HitAnimation" type="AnimatedSprite2D" parent="." node_paths=PackedStringArray("entity")]
scale = Vector2(0.75, 0.75)
sprite_frames = ExtResource("13_crijp")
animation = &"hit_spark"
script = ExtResource("20_n66tn")
entity = NodePath("..")

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(0, -1)
shape = SubResource("CircleShape2D_ki2kn")
debug_color = Color(0, 0.6, 0.701961, 0.215686)
script = ExtResource("43_4gaxh")

[node name="FollowPlayer" type="Node" parent="." node_paths=PackedStringArray("enemy", "speed")]
script = ExtResource("21_wnamf")
enemy = NodePath("..")
speed = NodePath("../Stats/MoveSpeed")

[node name="DamageListener" type="Node" parent="." node_paths=PackedStringArray("health", "health_manager")]
script = ExtResource("22_to4bi")
health = NodePath("../Stats/Health")
health_manager = NodePath("../HealthManager")

[node name="MagicResistMitigation" type="Node" parent="DamageListener" node_paths=PackedStringArray("mitigate_stat")]
script = ExtResource("23_1ypxb")
mitigate_stat = NodePath("../../Stats/MagicResist")
mitigation_type = 1

[node name="ArmorMitigation" type="Node" parent="DamageListener" node_paths=PackedStringArray("mitigate_stat")]
script = ExtResource("23_1ypxb")
mitigate_stat = NodePath("../../Stats/Armor")

[node name="DodgeModifier" type="Node" parent="DamageListener" node_paths=PackedStringArray("dodge_chance")]
script = ExtResource("19_v3qv3")
dodge_chance = NodePath("../../Stats/DodgeChance")
metadata/_custom_type_script = "uid://csugnbipwc8rl"

[node name="LevelManager" type="Node" parent="." node_paths=PackedStringArray("level_stat")]
script = ExtResource("24_tqk11")
level_stat = NodePath("../Stats/Level")

[node name="HealthManager" type="Node" parent="." node_paths=PackedStringArray("stat_manager", "max_health", "current_health", "health_regen", "max_shield", "current_shield", "shield_regen")]
script = ExtResource("25_uekoc")
stat_manager = NodePath("../Stats")
max_health = NodePath("../Stats/MaxHealth")
current_health = NodePath("../Stats/Health")
health_regen = NodePath("../Stats/HealthRegen")
max_shield = NodePath("../Stats/MaxShield")
current_shield = NodePath("../Stats/Shield")
shield_regen = NodePath("../Stats/ShieldRegen")

[node name="Stats" type="Node" parent="."]
script = ExtResource("2_ntwkw")

[node name="MoveSpeed" type="Node" parent="Stats"]
script = ExtResource("27_8hbk4")
stat_name = "move_speed"
stat_value = 210.0

[node name="StatScaler" type="Node" parent="Stats/MoveSpeed" node_paths=PackedStringArray("stat", "scale_with_stat")]
script = ExtResource("28_xylax")
stat = NodePath("..")
scale_with_stat = NodePath("../../Level")
scale_ratio = 5.0
metadata/_custom_type_script = "uid://clr8tbibqclow"

[node name="Health" type="Node" parent="Stats"]
script = ExtResource("27_8hbk4")
stat_name = "current_health"

[node name="MaxHealth" type="Node" parent="Stats"]
script = ExtResource("27_8hbk4")
stat_name = "max_health"
stat_value = 15.0

[node name="LevelStatScaler" type="Node" parent="Stats/MaxHealth" node_paths=PackedStringArray("stat", "scale_with_stat")]
script = ExtResource("28_xylax")
stat = NodePath("..")
scale_with_stat = NodePath("../../Level")
scale_ratio = 5.0

[node name="HealthRegen" type="Node" parent="Stats"]
script = ExtResource("27_8hbk4")
stat_name = "health_regen"

[node name="Armor" type="Node" parent="Stats"]
script = ExtResource("27_8hbk4")
stat_name = "armor"

[node name="LevelStatScaler" type="Node" parent="Stats/Armor" node_paths=PackedStringArray("stat", "scale_with_stat")]
script = ExtResource("28_xylax")
stat = NodePath("..")
scale_with_stat = NodePath("../../Level")

[node name="MagicResist" type="Node" parent="Stats"]
script = ExtResource("27_8hbk4")
stat_name = "magic_resist"

[node name="LevelStatScaler" type="Node" parent="Stats/MagicResist" node_paths=PackedStringArray("stat", "scale_with_stat")]
script = ExtResource("28_xylax")
stat = NodePath("..")
scale_with_stat = NodePath("../../Level")

[node name="Level" type="Node" parent="Stats"]
script = ExtResource("27_8hbk4")
stat_name = "level"

[node name="AttackSpeed" type="Node" parent="Stats"]
script = ExtResource("27_8hbk4")
stat_name = "attack_speed"
stat_value = 1.25

[node name="StatScaler" type="Node" parent="Stats/AttackSpeed" node_paths=PackedStringArray("stat", "scale_with_stat")]
script = ExtResource("28_xylax")
stat = NodePath("..")
scale_with_stat = NodePath("../../Level")
scale_ratio = 0.1
metadata/_custom_type_script = "uid://clr8tbibqclow"

[node name="AttackDamage" type="Node" parent="Stats"]
script = ExtResource("27_8hbk4")
stat_name = "attack_damage"
stat_value = 2.0

[node name="StatScaler" type="Node" parent="Stats/AttackDamage" node_paths=PackedStringArray("stat", "scale_with_stat")]
script = ExtResource("28_xylax")
stat = NodePath("..")
scale_with_stat = NodePath("../../Level")
scale_ratio = 0.5

[node name="Mana" type="Node" parent="Stats"]
script = ExtResource("27_8hbk4")
stat_name = "current_mana"

[node name="MaxMana" type="Node" parent="Stats"]
script = ExtResource("27_8hbk4")
stat_name = "max_mana"
stat_value = 100.0

[node name="ManaRegen" type="Node" parent="Stats"]
script = ExtResource("27_8hbk4")
stat_name = "mana_regen"
stat_value = 1.0

[node name="Shield" type="Node" parent="Stats"]
script = ExtResource("27_8hbk4")

[node name="MaxShield" type="Node" parent="Stats"]
script = ExtResource("27_8hbk4")

[node name="ShieldRegen" type="Node" parent="Stats"]
script = ExtResource("27_8hbk4")

[node name="DodgeChance" type="Node" parent="Stats"]
script = ExtResource("27_8hbk4")
stat_name = "dodge_chance"
metadata/_custom_type_script = "uid://bgka26pbphks7"

[node name="CooldownReduction" type="Node" parent="Stats"]
script = ExtResource("27_8hbk4")
stat_name = "cooldown_reduction"
stat_value = 5.0

[node name="LootDropManager" type="Node2D" parent="." node_paths=PackedStringArray("enemy")]
script = ExtResource("29_sk5q4")
enemy = NodePath("..")
drops = Array[PackedScene]([ExtResource("30_qoj44")])

[node name="RandomLootDropper" type="Node" parent="LootDropManager"]
script = ExtResource("44_2uo1e")
active = false

[node name="RareDropper" type="Node" parent="LootDropManager/RandomLootDropper"]
script = ExtResource("31_b73cx")
loot = ExtResource("45_xwpxq")
drop_chance = 2.0

[node name="CommonDropper" type="Node" parent="LootDropManager/RandomLootDropper"]
script = ExtResource("31_b73cx")
loot = ExtResource("46_x3gb8")
drop_chance = 5.0

[node name="LootDropper" type="Node" parent="LootDropManager/RandomLootDropper"]
script = ExtResource("31_b73cx")
drop_chance = 60.0

[node name="HealDropper" type="Node" parent="LootDropManager" node_paths=PackedStringArray("dropper")]
script = ExtResource("31_b73cx")
dropper = NodePath("..")
loot = ExtResource("52_adoa2")
drop_chance = 0.05

[node name="GoldDropper" type="Node" parent="LootDropManager" node_paths=PackedStringArray("dropper")]
script = ExtResource("60_1bywy")
dropper = NodePath("..")
loot = ExtResource("59_k26d3")
active = false
metadata/_custom_type_script = "uid://4aq4lbc1j01f"

[node name="Panel" type="Panel" parent="."]
offset_left = -62.0
offset_top = -86.0
offset_right = 71.0
offset_bottom = -70.0
theme_override_styles/panel = SubResource("StyleBoxFlat_usn8p")

[node name="MarginContainer" type="MarginContainer" parent="Panel"]
custom_minimum_size = Vector2(125, 6)
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -25.0
offset_top = -3.0
offset_right = 25.0
offset_bottom = 3.0
grow_horizontal = 2
grow_vertical = 2

[node name="TextureProgressBar" parent="Panel/MarginContainer" node_paths=PackedStringArray("health_manager") instance=ExtResource("36_spbdk")]
layout_mode = 2
health_manager = NodePath("../../../HealthManager")

[node name="DamageNumber" type="Node" parent="."]
script = ExtResource("37_hr30q")

[node name="EntityHitStreamPlayer2D" type="AudioStreamPlayer2D" parent="." node_paths=PackedStringArray("entity")]
stream = ExtResource("38_wst1g")
script = ExtResource("39_i6u0l")
entity = NodePath("..")

[node name="EntityHitParticle" type="Node" parent="." node_paths=PackedStringArray("entity", "hit_particle")]
script = ExtResource("40_sfnxl")
entity = NodePath("..")
particle_scene = ExtResource("50_1vlta")
hit_particle = NodePath("../EnemyHitSparkParticle")

[node name="EnemyHitSparkParticle" parent="." instance=ExtResource("50_1vlta")]

[editable path="Panel/MarginContainer/TextureProgressBar"]
